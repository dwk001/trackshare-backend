import{j as e,c as a,L as s}from"./index-BgWSfIsJ.js";import{r as t}from"./vendor-KIEtaiwe.js";import{u as r,b as i,c as l}from"./query-Y2oWywPX.js";import{a as c}from"./apiService-sJWJ5l_Y.js";import{m as n,T as o,U as d,q as x,a as m,C as h,B as p,n as y,o as g,H as j,r as u,k as b,P as N,E as v}from"./ui-D7Ik4R0t.js";import"./router-mjhA_Ms8.js";import"./utils-CrFdsnXa.js";const f=[{id:"trending",label:"Trending",icon:o,public:!0},{id:"friends",label:"Friends",icon:d,public:!1},{id:"groups",label:"Groups",icon:x,public:!1},{id:"challenges",label:"Challenges",icon:m,public:!1},{id:"events",label:"Events",icon:h,public:!1},{id:"analytics",label:"Analytics",icon:p,public:!1}];function k({className:d}){const[x,m]=t.useState("trending"),[h,p]=t.useState(!1),k=r(),{data:w,isLoading:C,error:T,refetch:S}=i(["posts",x],()=>c.getPosts({feedType:x}),{staleTime:12e4,cacheTime:3e5}),L=l(e=>c.likePost(e),{onSuccess:()=>{k.invalidateQueries(["posts",x])}}),M=l(e=>c.sharePost(e),{onSuccess:()=>{k.invalidateQueries(["posts",x])}}),P=w?.data||[],z=w?.pagination?.has_more||!1,D=e=>{const a=new Date,s=new Date(e),t=Math.floor((a.getTime()-s.getTime())/1e3);return t<60?"Just now":t<3600?`${Math.floor(t/60)}m ago`:t<86400?`${Math.floor(t/3600)}h ago`:t<2592e3?`${Math.floor(t/86400)}d ago`:s.toLocaleDateString()},A=a=>"track"===a.type?e.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsxs("div",{className:"relative flex-shrink-0",children:[e.jsx("img",{src:a.track?.artwork||a.track?.artworkMedium||"/placeholder-music.jpg",alt:a.track?.title,className:"w-16 h-16 rounded-lg object-cover",loading:"lazy"}),e.jsx("button",{onClick:()=>{a.track},className:"absolute inset-0 bg-black bg-opacity-0 hover:bg-opacity-30 rounded-lg flex items-center justify-center transition-all duration-300",children:e.jsx(N,{className:"w-6 h-6 text-white opacity-0 hover:opacity-100 transition-opacity"})})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white truncate",children:a.track?.title}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm truncate",children:a.track?.artist}),a.track?.album&&e.jsx("p",{className:"text-gray-500 dark:text-gray-500 text-xs truncate",children:a.track.album}),e.jsxs("div",{className:"flex items-center space-x-4 mt-2",children:[e.jsxs("button",{onClick:()=>{a.track},className:"flex items-center space-x-1 text-primary-500 hover:text-primary-600 transition-colors",children:[e.jsx(N,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Play"})]}),e.jsxs("button",{className:"flex items-center space-x-1 text-gray-500 hover:text-gray-700 dark:hover:text-gray-300 transition-colors",children:[e.jsx(v,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Open"})]})]})]})]})}):"playlist"===a.type?e.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"relative flex-shrink-0",children:e.jsx("img",{src:a.playlist?.coverImage||"/placeholder-playlist.jpg",alt:a.playlist?.name,className:"w-16 h-16 rounded-lg object-cover",loading:"lazy"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white truncate",children:a.playlist?.name}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-400 text-sm",children:[a.playlist?.trackCount," tracks"]}),e.jsx("p",{className:"text-gray-500 dark:text-gray-500 text-xs truncate",children:a.playlist?.description})]})]})}):null;return e.jsx("div",{className:a("min-h-screen bg-gray-50 dark:bg-gray-900",d),children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs(n.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-4",children:"Social Feed"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Discover what your friends are listening to and share your musical journey."})]}),e.jsx(n.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm mb-6",children:e.jsx("div",{className:"flex overflow-x-auto",children:f.map(s=>{const t=s.icon;return e.jsxs("button",{onClick:()=>{return e=s.id,void m(e);var e},className:a("flex items-center space-x-2 px-6 py-4 text-sm font-medium border-b-2 transition-colors whitespace-nowrap",x===s.id?"border-primary-500 text-primary-600 dark:text-primary-400":"border-transparent text-gray-500 hover:text-gray-700 dark:hover:text-gray-300"),children:[e.jsx(t,{className:"w-4 h-4"}),e.jsx("span",{children:s.label})]},s.id)})})}),e.jsx("div",{className:"space-y-6",children:C?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(s,{size:"lg"})}):T?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-red-500 mb-4",children:"Failed to load posts"}),e.jsx("button",{onClick:()=>S(),className:"px-4 py-2 bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-colors",children:"Try Again"})]}):0===P.length?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-200 dark:bg-gray-700 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(o,{className:"w-8 h-8 text-gray-400"})}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No posts found. Be the first to share something!"})]}):e.jsx(y,{children:P.map((s,t)=>e.jsxs(n.article,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{delay:.05*t},className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 pb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("img",{src:s.user?.avatar||"/placeholder-avatar.jpg",alt:s.user?.displayName,className:"w-10 h-10 rounded-full object-cover",loading:"lazy"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:s.user?.displayName}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:D(s.createdAt)})]})]}),e.jsx("button",{className:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors",children:e.jsx(g,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"px-6 pb-4",children:[s.content&&e.jsx("p",{className:"text-gray-900 dark:text-white mb-4 whitespace-pre-wrap",children:s.content}),A(s)]}),e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-t border-gray-100 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsxs("button",{onClick:()=>{return e=s.id,void L.mutate(e);var e},className:a("flex items-center space-x-2 transition-colors",s.isLiked?"text-red-500":"text-gray-500 hover:text-red-500"),children:[e.jsx(j,{className:a("w-5 h-5",s.isLiked&&"fill-current")}),e.jsx("span",{className:"text-sm",children:s.likeCount||0})]}),e.jsxs("button",{className:"flex items-center space-x-2 text-gray-500 hover:text-primary-500 transition-colors",children:[e.jsx(u,{className:"w-5 h-5"}),e.jsx("span",{className:"text-sm",children:s.commentCount||0})]}),e.jsxs("button",{onClick:()=>{return e=s.id,void M.mutate(e);var e},className:"flex items-center space-x-2 text-gray-500 hover:text-primary-500 transition-colors",children:[e.jsx(b,{className:"w-5 h-5"}),e.jsx("span",{className:"text-sm",children:s.shareCount||0})]})]}),e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:s.platform&&e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gray-100 dark:bg-gray-700",children:s.platform})})]})]},s.id))})}),z&&e.jsx("div",{className:"text-center mt-8",children:e.jsx("button",{className:"px-6 py-3 bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-colors",children:"Load More Posts"})})]})})}function w(){return e.jsx(k,{})}export{w as default};
