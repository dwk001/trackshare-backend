import{u as e,j as t,c as a,L as r}from"./index-D4BaGRmT.js";import{r as i,a as s}from"./vendor-KIEtaiwe.js";import{I as o,g as n}from"./GoogleAd-QPIL-29J.js";import{p as l,d as c}from"./deepLinkService-COYD9DVj.js";import{P as d}from"./PageBanner-d-MSZrls.js";import{F as x,m as g,P as m,H as y,k as p,l as u}from"./ui-D7Ik4R0t.js";import"./router-mjhA_Ms8.js";import"./query-Y2oWywPX.js";import"./utils-CrFdsnXa.js";import"./apiService-sJWJ5l_Y.js";function h(){const{isAuthenticated:h,user:M}=e(),[N,j]=i.useState([]),[w,b]=i.useState(!0),[I,v]=i.useState(null),[k,A]=i.useState([]),[D,T]=i.useState("all"),[f,E]=i.useState(!1);i.useEffect(()=>{(async()=>{try{b(!0),v(null);const e=await n("all"===D?void 0:D);j(e)}catch(e){v("Failed to load trending tracks. Please try again.")}finally{b(!1)}})()},[D]),i.useEffect(()=>{h&&(async()=>{try{const e=await l.getConnectedProviders();A(e)}catch(e){}})()},[h]);const z=()=>{(async()=>{try{b(!0),v(null);const e=await n("all"===D?void 0:D);j(e)}catch(e){v("Failed to load trending tracks. Please try again.")}finally{b(!1)}})()};return t.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[t.jsx(d,{variant:"trending",title:"Trending Music",subtitle:"Discover what's hot right now",description:"Find the most popular tracks across all music platforms and genres",buttons:{primary:{text:"Refresh",onClick:z,className:w?"opacity-50 cursor-not-allowed":""},secondary:{text:"View All",onClick:()=>navigate("/discovery")}}}),t.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700",children:t.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center space-x-4",children:[t.jsxs("button",{onClick:()=>E(!f),className:"flex items-center px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors",children:[t.jsx(x,{className:"w-4 h-4 mr-2"}),"Filters"]}),f&&t.jsx("div",{className:"flex items-center space-x-2",children:[{id:"all",name:"All Genres"},{id:"pop",name:"Pop"},{id:"rock",name:"Rock"},{id:"hip-hop",name:"Hip-Hop"},{id:"electronic",name:"Electronic"},{id:"country",name:"Country"},{id:"jazz",name:"Jazz"},{id:"classical",name:"Classical"}].map(e=>t.jsx("button",{onClick:()=>T(e.id),className:a("px-3 py-1 rounded-full text-sm font-medium transition-colors",D===e.id?"bg-primary-500 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"),children:e.name},e.id))})]}),t.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:[N.length," tracks found"]})]})})}),t.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:w?t.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:t.jsx(r,{size:"lg"})}):I?t.jsxs("div",{className:"text-center py-12",children:[t.jsx("div",{className:"text-red-400 mb-4",children:I}),t.jsx("button",{onClick:z,className:"px-6 py-3 bg-white text-primary-600 font-semibold rounded-lg hover:bg-gray-100 transition-colors",children:"Try Again"})]}):t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:N.map((e,a)=>t.jsxs(s.Fragment,{children:[t.jsxs(g.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*a},className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg overflow-hidden group hover:shadow-xl transition-all duration-300",children:[t.jsxs("div",{className:"relative aspect-square",children:[t.jsx("img",{src:e.artwork||"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzAwIiBoZWlnaHQ9IjMwMCIgdmlld0JveD0iMCAwIDMwMCAzMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIzMDAiIGhlaWdodD0iMzAwIiBmaWxsPSIjRjNGNEY2Ii8+CjxwYXRoIGQ9Ik0xNTAgMTAwQzEzMy42IDEwMCAxMjAgMTEzLjYgMTIwIDEzMEMxMjAgMTQ2LjQgMTMzLjYgMTYwIDE1MCAxNjBDMTY2LjQgMTYwIDE4MCAxNDYuNCAxODAgMTMwQzE4MCAxMTMuNiAxNjYuNCAxMDAgMTUwIDEwMFoiIGZpbGw9IiM5Q0EzQUYiLz4KPHBhdGggZD0iTTE1MCAxNDBDMTQyLjMgMTQwIDEzNiAxNDYuMyAxMzYgMTU0QzEzNiAxNjEuNyAxNDIuMyAxNjggMTUwIDE2OEMxNTcuNyAxNjggMTY0IDE2MS43IDE2NCAxNTRDMTY0IDE0Ni4zIDE1Ny43IDE0MCAxNTAgMTQwWiIgZmlsbD0iIzlDQTNBRiIvPgo8L3N2Zz4K",alt:`${e.title} by ${e.artist}`,className:"w-full h-full object-cover",onError:e=>{e.currentTarget.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzAwIiBoZWlnaHQ9IjMwMCIgdmlld0JveD0iMCAwIDMwMCAzMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIzMDAiIGhlaWdodD0iMzAwIiBmaWxsPSIjRjNGNEY2Ii8+CjxwYXRoIGQ9Ik0xNTAgMTAwQzEzMy42IDEwMCAxMjAgMTEzLjYgMTIwIDEzMEMxMjAgMTQ2LjQgMTMzLjYgMTYwIDE1MCAxNjBDMTY2LjQgMTYwIDE4MCAxNDYuNCAxODAgMTMwQzE4MCAxMTMuNiAxNjYuNCAxMDAgMTUwIDEwMFoiIGZpbGw9IiM5Q0EzQUYiLz4KPHBhdGggZD0iTTE1MCAxNDBDMTQyLjMgMTQwIDEzNiAxNDYuMyAxMzYgMTU0QzEzNiAxNjEuNyAxNDIuMyAxNjggMTUwIDE2OEMxNTcuNyAxNjggMTY0IDE2MS43IDE2NCAxNTRDMTY0IDE0Ni4zIDE1Ny43IDE0MCAxNTAgMTQwWiIgZmlsbD0iIzlDQTNBRiIvPgo8L3N2Zz4K"}}),t.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-30 transition-all duration-300 flex items-center justify-center",children:t.jsx("button",{onClick:()=>(async e=>{try{if(h&&k.length>0){const t=k[0];await c.openInProvider(e,t.provider)}}catch(t){}})(e),className:"opacity-100 md:opacity-0 md:group-hover:opacity-100 bg-white bg-opacity-90 rounded-full p-4 hover:bg-opacity-100 active:bg-opacity-100 transition-all duration-300 transform scale-75 group-hover:scale-100 min-h-[56px] min-w-[56px] touch-manipulation cursor-pointer select-none",style:{WebkitTouchCallout:"none",WebkitUserSelect:"none",userSelect:"none"},children:t.jsx(m,{className:"w-6 h-6 text-gray-900 ml-1"})})}),t.jsxs("div",{className:"absolute top-2 left-2 bg-primary-500 text-white text-sm font-bold px-2 py-1 rounded",children:["#",e.position]}),t.jsx("div",{className:"absolute top-2 right-2 bg-black bg-opacity-50 text-white text-xs px-2 py-1 rounded",children:e.source})]}),t.jsxs("div",{className:"p-4",children:[t.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white text-lg mb-1 truncate",children:e.title}),t.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm mb-1 truncate",children:e.artist}),e.album&&t.jsx("p",{className:"text-gray-500 dark:text-gray-500 text-xs truncate mb-4",children:e.album}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center space-x-1",children:[t.jsx("button",{onClick:()=>(async e=>{try{if(!h)return localStorage.setItem("pendingFavorite",JSON.stringify({trackId:e.id,trackTitle:e.title,trackArtist:e.artist,trackArtwork:e.artwork})),void(window.location.href="/signin?redirect="+encodeURIComponent(window.location.pathname))}catch(t){}})(e),className:"p-3 text-gray-400 hover:text-red-500 active:text-red-500 transition-colors min-h-[44px] min-w-[44px] touch-manipulation cursor-pointer select-none",style:{WebkitTouchCallout:"none",WebkitUserSelect:"none",userSelect:"none"},"aria-label":"Like track",children:t.jsx(y,{className:"w-5 h-5"})}),t.jsx("button",{onClick:()=>(async e=>{try{const t=await c.generateShareLink(e);navigator.share?await navigator.share({title:`${e.title} by ${e.artist}`,text:`Check out this track: ${e.title} by ${e.artist}`,url:t.url}):await navigator.clipboard.writeText(t.url)}catch(t){}})(e),className:"p-3 text-gray-400 hover:text-primary-500 active:text-primary-500 transition-colors min-h-[44px] min-w-[44px] touch-manipulation cursor-pointer select-none",style:{WebkitTouchCallout:"none",WebkitUserSelect:"none",userSelect:"none"},"aria-label":"Share track",children:t.jsx(p,{className:"w-5 h-5"})}),t.jsx("button",{onClick:()=>(async e=>{try{if(!h||!M?.id)return alert("Please sign in to post tracks to your feed"),void navigate("/auth");const t=await fetch("/api/posts/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:"track",track:{id:e.id,title:e.title,artist:e.artist,album:e.album,artwork:e.artwork||e.artworkMedium,url:e.url,provider:e.provider||"itunes"},userId:M.id})});if(!t.ok){const e=await t.json().catch(()=>({error:"Unknown error"}));throw new Error(e.error||"Failed to create post")}await t.json(),alert("Track posted to your feed!")}catch(t){alert(`Failed to post track: ${t instanceof Error?t.message:"Unknown error"}`)}})(e),className:"p-3 text-gray-400 hover:text-blue-500 active:text-blue-500 transition-colors min-h-[44px] min-w-[44px] touch-manipulation cursor-pointer select-none",style:{WebkitTouchCallout:"none",WebkitUserSelect:"none",userSelect:"none"},"aria-label":"Post track",children:t.jsx(u,{className:"w-5 h-5"})})]}),t.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Trending"})]})]})]}),(a+1)%6==0&&t.jsx("div",{className:"col-span-1 md:col-span-2 lg:col-span-3 xl:col-span-4",children:t.jsx(o,{})})]},e.id))})})]})}export{h as default};
