import{j as e,c as a,L as t}from"./index-yA_UH8mL.js";import{r}from"./vendor-SeVIIybd.js";import{m as s,S as i,i as l,M as o,P as n,H as c,h as d,j as x}from"./ui-BfNYVWSp.js";import"./router-DXo_BilD.js";import"./query-IysHnqDy.js";import"./utils-CrFdsnXa.js";const m=async e=>{if(!e.trim())return[];try{const a=await(async e=>{const a=await fetch(`https://itunes.apple.com/search?term=${encodeURIComponent(e)}&media=music&limit=20`);if(!a.ok)throw new Error(`iTunes API error: ${a.status}`);const t=await a.json();return t.results&&0!==t.results.length?t.results.map(e=>({id:e.trackId,title:e.trackName,artist:e.artistName,album:e.collectionName,artwork:e.artworkUrl100?.replace("100x100","300x300")||"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzAwIiBoZWlnaHQ9IjMwMCIgdmlld0JveD0iMCAwIDMwMCAzMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIzMDAiIGhlaWdodD0iMzAwIiBmaWxsPSIjNjY3ZWVhIi8+CjxjaXJjbGUgY3g9IjE1MCIgY3k9IjE1MCIgcj0iNTAiIGZpbGw9IndoaXRlIi8+CjxwYXRoIGQ9Ik0xMjAgMTIwSDIwMFYxODBIMTIwVjEyMFoiIGZpbGw9IndoaXRlIi8+CjxwYXRoIGQ9Ik0xMjAgMTIwSDIwMFYxODBIMTIwVjEyMFoiIGZpbGw9IndoaXRlIi8+CjxwYXRoIGQ9Ik0xMjAgMTIwSDIwMFYxODBIMTIwVjEyMFoiIGZpbGw9IndoaXRlIi8+Cjwvc3ZnPgo=",previewUrl:e.previewUrl,url:e.trackViewUrl,duration:e.trackTimeMillis,releaseDate:e.releaseDate,provider:"itunes"})):[]})(e);if(a.length>0)return a}catch(a){}try{const a=await(async e=>{const a=await fetch(`https://api.deezer.com/search?q=${encodeURIComponent(e)}&limit=20`);if(!a.ok)throw new Error(`Deezer API error: ${a.status}`);const t=await a.json();return t.data&&0!==t.data.length?t.data.map(e=>({id:e.id,title:e.title,artist:e.artist.name,album:e.album.title,artwork:e.album.cover_xl||e.album.cover_medium||"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzAwIiBoZWlnaHQ9IjMwMCIgdmlld0JveD0iMCAwIDMwMCAzMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIzMDAiIGhlaWdodD0iMzAwIiBmaWxsPSIjNjY3ZWVhIi8+CjxjaXJjbGUgY3g9IjE1MCIgY3k9IjE1MCIgcj0iNTAiIGZpbGw9IndoaXRlIi8+CjxwYXRoIGQ9Ik0xMjAgMTIwSDIwMFYxODBIMTIwVjEyMFoiIGZpbGw9IndoaXRlIi8+CjxwYXRoIGQ9Ik0xMjAgMTIwSDIwMFYxODBIMTIwVjEyMFoiIGZpbGw9IndoaXRlIi8+CjxwYXRoIGQ9Ik0xMjAgMTIwSDIwMFYxODBIMTIwVjEyMFoiIGZpbGw9IndoaXRlIi8+Cjwvc3ZnPgo=",previewUrl:e.preview,url:e.link,duration:e.duration?1e3*e.duration:void 0,releaseDate:e.release_date,provider:"deezer"})):[]})(e);return a}catch(a){throw new Error("Music search is temporarily unavailable. Please try again later.")}},g=[{value:"all",label:"All Genres"},{value:"pop",label:"Pop"},{value:"rock",label:"Rock"},{value:"hip-hop",label:"Hip-Hop"},{value:"electronic",label:"Electronic"},{value:"country",label:"Country"},{value:"jazz",label:"Jazz"},{value:"classical",label:"Classical"}];function h({className:h}){const[u,y]=r.useState(""),[p,j]=r.useState([]),[b,w]=r.useState(!1),[I,v]=r.useState(null),[k,N]=r.useState(!1),[f,M]=r.useState(!1),[C,D]=r.useState("all"),[G,S]=r.useState("auto");r.useEffect(()=>{if(!u.trim())return j([]),void N(!1);const e=setTimeout(async()=>{w(!0),v(null);try{const e=await m(u);j(e),N(!0),M(!0)}catch(e){v(e instanceof Error?e.message:"Search failed"),j([])}finally{w(!1)}},500);return()=>clearTimeout(e)},[u,C,G]);return e.jsx("div",{className:a("min-h-screen bg-white dark:bg-gray-900",h),children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs(s.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center mb-8",children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-gray-900 dark:text-white mb-4",children:"Discover Music"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 max-w-2xl mx-auto",children:"Find trending tracks, get personalized recommendations, and discover new music across all genres."})]}),e.jsx(s.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"max-w-2xl mx-auto mb-8",children:e.jsxs("div",{className:"relative",children:[e.jsx(i,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"Search for songs, artists, or paste a music link...",value:u,onChange:e=>y(e.target.value),className:"w-full pl-12 pr-4 py-3 text-lg rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent"}),b&&e.jsx("div",{className:"absolute right-4 top-1/2 transform -translate-y-1/2",children:e.jsx(t,{size:"sm"})})]})}),e.jsx(l,{children:f&&e.jsxs(s.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"bg-gray-50 dark:bg-gray-800 rounded-lg p-6 mb-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Search Filters"}),e.jsx("button",{onClick:()=>M(!1),className:"text-gray-500 hover:text-gray-700 dark:hover:text-gray-300 transition-colors",children:"Hide Filters"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Search Provider"}),e.jsxs("select",{value:G,onChange:e=>S(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[e.jsx("option",{value:"auto",children:"Auto (iTunes + Deezer)"}),e.jsx("option",{value:"itunes",children:"iTunes Only"}),e.jsx("option",{value:"deezer",children:"Deezer Only"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Genre"}),e.jsx("select",{value:C,onChange:e=>D(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:g.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))})]})]})]})}),e.jsx("div",{className:"mb-8",children:b?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(t,{size:"lg"})}):I?e.jsx("div",{className:"text-center py-12",children:e.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-6 max-w-md mx-auto",children:[e.jsx("p",{className:"text-red-600 dark:text-red-400 mb-4",children:I}),e.jsx("button",{onClick:()=>{u.trim()&&(w(!0),v(null),m(u).then(e=>{j(e),w(!1)}).catch(e=>{v(e instanceof Error?e.message:"Search failed"),w(!1)}))},className:"px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors",children:"Try Again"})]})}):k&&0===p.length?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(i,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"No tracks found"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:"Try searching for a different artist or song name"}),e.jsxs("div",{className:"text-sm text-gray-400",children:[e.jsx("p",{children:"Search tips:"}),e.jsxs("ul",{className:"mt-2 space-y-1",children:[e.jsx("li",{children:'• Try just the artist name (e.g., "Drake")'}),e.jsx("li",{children:'• Use partial names (e.g., "Taylor" for Taylor Swift)'}),e.jsx("li",{children:"• Check spelling and try variations"})]})]})]}):k?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:['Search Results for "',u,'"']}),e.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:[p.length," tracks found"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:p.map((a,t)=>e.jsxs(s.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.05*t},className:"bg-white dark:bg-gray-800 rounded-lg shadow-md hover:shadow-lg transition-shadow group",children:[e.jsxs("div",{className:"relative aspect-square rounded-t-lg overflow-hidden",children:[e.jsx("img",{src:a.artwork||"/placeholder-music.jpg",alt:a.title,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300",loading:"lazy",onError:e=>{e.currentTarget.src="/placeholder-music.jpg"}}),e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-30 transition-all duration-300 flex items-center justify-center",children:e.jsx("button",{onClick:()=>(e=>{e.provider,window.open(e.url,"_blank")})(a),className:"opacity-0 group-hover:opacity-100 bg-white bg-opacity-90 rounded-full p-3 hover:bg-opacity-100 transition-all duration-300 transform scale-75 group-hover:scale-100",children:e.jsx(n,{className:"w-6 h-6 text-gray-900 ml-1"})})}),e.jsx("div",{className:"absolute top-2 right-2 bg-black bg-opacity-50 text-white text-xs px-2 py-1 rounded",children:a.provider})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white truncate mb-1",children:a.title}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm truncate mb-2",children:a.artist}),a.album&&e.jsx("p",{className:"text-gray-500 dark:text-gray-500 text-xs truncate mb-3",children:a.album}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>{},className:"p-2 text-gray-400 hover:text-red-500 transition-colors","aria-label":"Like track",children:e.jsx(c,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>(e=>{const a=`${window.location.origin}/t/${e.id}`;navigator.share?navigator.share({title:`${e.title} by ${e.artist}`,text:`Check out this track: ${e.title}`,url:a}):navigator.clipboard.writeText(a)})(a),className:"p-2 text-gray-400 hover:text-primary-500 transition-colors","aria-label":"Share track",children:e.jsx(d,{className:"w-4 h-4"})})]}),e.jsx("button",{className:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors","aria-label":"More options",children:e.jsx(x,{className:"w-4 h-4"})})]})]})]},`${a.provider}-${a.id}`))})]}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(o,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"Start searching for music"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Enter an artist name, song title, or paste a music link to get started"})]})})]})})}export{h as default};
